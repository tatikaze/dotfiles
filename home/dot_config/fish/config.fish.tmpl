{{- /* Fish Shell Configuration - Cross-platform */ -}}

## 全OS共通設定
set -x EDITOR nvim

## golang
set -x GOPATH $HOME/go
set -x PATH $PATH $GOPATH/bin

## rust
set -x CARGOPATH $HOME/.cargo/bin
set -x PATH $PATH $CARGOPATH

## volta (Node.js version manager)
set -x VOLTA_HOME "$HOME/.volta"
set -x PATH "$VOLTA_HOME/bin" $PATH

## bun
set -x BUN_INSTALL "$HOME/.bun"
set -x PATH $BUN_INSTALL/bin $PATH

## Docker
set -x PATH $PATH ~/.docker/bin

## Custom Commands
set -x CCOMMAND_PATH $HOME/Projects/custom-command
set -x PATH $PATH $CCOMMAND_PATH

## Unmanaged CLIs
set -x CLIS ~/.cli

{{- if eq .chezmoi.os "darwin" }}
## macOS専用設定

# Homebrew
set -x HOMEBREW /opt/homebrew
set -x PATH /usr/local/bin $HOMEBREW/bin $PATH

# MySQL Client (Homebrew)
fish_add_path /opt/homebrew/opt/mysql-client@5.7/bin

# pnpm (macOS location)
set -gx PNPM_HOME "$HOME/Library/pnpm"
set -gx PATH "$PNPM_HOME" $PATH

# Android SDK
set -x PATH $PATH ~/Library/Android/sdk/platform-tools

# Flutter
set -x PATH $PATH $CLIS/flutter/bin
set -x PATH $PATH $CLI/flutter/.pub-cache/bin

# macOS用エイリアス
alias pbcopy='pbcopy'
alias pbpaste='pbpaste'

{{- else if eq .chezmoi.os "linux" }}
## Linux専用設定

# Homebrew (Linuxbrew)
set -x HOMEBREW /home/linuxbrew/.linuxbrew
set -x PATH /usr/local/bin $HOMEBREW/bin $PATH

# pnpm (Linux location)
set -gx PNPM_HOME "$HOME/.local/share/pnpm"
set -gx PATH "$PNPM_HOME" $PATH

# Android SDK (Linux)
if test -d "$HOME/Android/Sdk"
    set -x PATH $PATH $HOME/Android/Sdk/platform-tools
end

# Clipboard aliases (Linux)
if command -v xclip > /dev/null
    alias pbcopy='xclip -selection clipboard'
    alias pbpaste='xclip -selection clipboard -o'
else if command -v wl-copy > /dev/null
    # Wayland
    alias pbcopy='wl-copy'
    alias pbpaste='wl-paste'
end

{{- else if eq .chezmoi.os "windows" }}
## Windows (WSL) 専用設定

# WSL2環境ではルートディレクトリがwindows側になる
cd $HOME

# Windows側のツールパス
set -x PATH $PATH /mnt/c/Program\ Files/bin

# pnpm (Windows/WSL location)
set -gx PNPM_HOME "$HOME/.local/share/pnpm"
set -gx PATH "$PNPM_HOME" $PATH

# Clipboard aliases (WSL)
alias pbcopy='clip.exe'
alias pbpaste='powershell.exe Get-Clipboard'

{{- end }}

## 共通関数
function eza_flex_tree
    ls -l --tree --level=$argv
end

## 共通エイリアス
alias cat='bat'
alias ls='eza --git'
alias lsa='eza --git'
alias lc='clear && pwd && ls'
alias doco='docker compose'
alias tre='eza_flex_tree'
alias vim='nvim'
alias pwdc='pwd | pbcopy'

## ghq (リポジトリ管理)
bind \cg "select_ghq_repository"
alias selectr='select_ghq_repository'
